\newpage
# 03. orders {#intro}  

```{r 3.0.1-global, echo=FALSE, include=FALSE, message = FALSE, warning=FALSE}
library(data.table)
library(dplyr)
library(flextable)
library(kableExtra)
library(officer)
```

```{r 3.0.2-setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r 3.0.3-tinytex, include=FALSE}
options(tinytex.verbose = TRUE)
```

```{r 3.0.4-rdsInput, echo=FALSE}
currentAY_row <- as.integer(readRDS(here::here("/rds", "currentAY_row.rds")))
dt03_aid_wide <- setDT(readRDS(here::here("/rds", "dt03_aid_wide.rds")))
```
```{r 3.0.5-duke-logo, echo=FALSE, out.width = '100%'}
knitr::include_graphics(here::here('images/duke.png'))
```

<h2><center><b>Financial Aid Awarded</b></center></h2>

```{r 3.1.0-coa-flextable}

ft_aid <- flextable(dt03_aid_wide) %>%
  suppressMessages(
  ) %>%
  align_text_col(align = "center"
  ) %>%
  merge_v(j = ~ Level
  ) %>%
  bold(j = 1, i = ~ !is.na(Level), bold = TRUE, part = "body"
  ) %>%
  bold(part = "all", bold = TRUE
  ) %>%
  colformat_num(
    i = ~ Description != "Total Aid",
    big.mark = ",", digits = 0, na_str = ""
  ) %>%
  colformat_num(
    i = ~ Description == "Total Aid",
    j = -c(1:2),
    big.mark = ",", digits = 0, na_str = "", prefix = "$"
  ) %>%
  bg(bg = '#7f827c', part = 'header'
  ) %>%
  bg(i = 1:3, bg = '#BA0C2F'
  ) %>%
  bg(i = 4:6, bg = '#000000'
  ) %>%
  bg(i = 7:9, bg = '#19488a'
  ) %>%
  color(color = "white", part = "all"
  ) %>%
  fit_to_width(max_width = 8.0
  ) %>%
  autofit(
  ) %>%
  fontsize(size = 7.00, part = "all"
  ) %>%  
  width(j = 1,   width = 1.00
  ) %>%
  width(j = 2:7, width = 0.90)  %>%  
  flextable::set_caption("")
#  hBorder    <- officer::fp_border(color = '#19488a', style = "solid", width = 1)
#  ft_aid     <- hline(ft_aid, i = c(3,6), border = hBorder)
  vBorder    <- officer::fp_border(color = 'white', style = "solid", width = 1)
  ft_aid     <- vline(ft_aid, j = 1, border = vBorder)

suppressWarnings(ft_aid)
```

## 03. Average Award Per Undergraduate Recipient chart
```{r 3.1.1-viz-bar}
knitr::include_graphics(here::here('png/p03a1_bar.png'))
```

## 03. Average Award Per Graduate Recipient Chart
```{r 3.2.1.a-viz-bar}
knitr::include_graphics(here::here('png/p03a2_bar.png'))
```
