# ------------------------------------------------------------------------------
# 01. Volatility                                                             ---
# ------------------------------------------------------------------------------
################################################################################
## Step 01.01 clean the tables                                               ###
################################################################################
x01 <- grep("^dt", ls(), value = TRUE)
# ------------------------------------------------------------------------------
lapply(x01, function(nm) {
  df  <- get(nm)
  setDT(df)
  setkey(df, "id")
  setorder(df, id)
# ------------------------------------------------------------------------------
# g[[paste0("dx", "_", nm)]]  <<- df
#  data.table::setDT(g[[paste0("dx", "_", nm)]], keep.rownames = TRUE)  
#  g[[paste0("dx", "_", nm)]]  <<- data.table::as.xts.data.table(get(nm))
# ------------------------------------------------------------------------------
  g[[paste0("tb", "_", nm)]]  <<- tibble::as_tibble(get(nm))
# ------------------------------------------------------------------------------
  }
)
################################################################################
## Step 01.02 merge the tables                                               ###
################################################################################
dt.retail    <- rbind(dt.data, dt.output)
# ------------------------------------------------------------------------------
dx_msa_5190  <- xts::as.xts(dt.retail_daily[id_region == '805190',])
dx_zip_8723  <- xts::as.xts(dt.retail_daily[id_region == '8723',])
dx_zip_8724  <- xts::as.xts(dt.retail_daily[id_region == '8724',])
# ------------------------------------------------------------------------------
ret.cum_5190 <- 1 + (TTR::ROC(dx_msa_5190[,"retail_avg"])) - 1
ret.cum_8723 <- 1 + (TTR::ROC(dx_zip_8723[,"retail_avg"])) - 1
ret.cum_8724 <- 1 + (TTR::ROC(dx_zip_8724[,"retail_avg"])) - 1
# ------------------------------------------------------------------------------
chart.TimeSeries(ret.cum_5190, colorset = "darkblue")
png("monmouth.png")
chart.TimeSeries(ret.cum_8723, colorset = "darkblue")
png("x08723.png")
chart.TimeSeries(ret.cum_8724, colorset = "darkblue")
ggsave("x08724.png")
################################################################################
## Step 00.99: VERSION HISTORY                                               ###
################################################################################
a00.version = "1.0.0"
a00.ModDate = as.Date("2022-10-15")
# ------------------------------------------------------------------------------
# 2022.10.15 - v.1.0.0
# 1st release
# ------------------------------------------------------------------------------
